const e=["fields","filter","search","sort","limit","offset","page","deep","backlink","alias","aggregate","groupBy","version","versionRaw"],t=e=>"string"==typeof e&&!!e,s=e=>"number"==typeof e,r=e=>Array.isArray(e)&&e.length>0,i=e=>"object"==typeof e&&!!e&&!r(e)&&Object.keys(e).length>0,o={fetch:globalThis.fetch,WebSocket:globalThis.WebSocket,URL:globalThis.URL,logger:globalThis.console},a=(e,t={})=>{let s=t.globals?{...o,...t.globals}:o;return{globals:s,url:new s.URL(e),with(e){return{...this,...e(this)}}}},n=(e,t)=>()=>((e=>{if(0===e.length)throw Error("Collection cannot be empty")})(String(e)),(e=>{if(t=String(e),"directus_access.directus_activity.directus_collections.directus_comments.directus_fields.directus_files.directus_folders.directus_migrations.directus_permissions.directus_policies.directus_presets.directus_relations.directus_revisions.directus_roles.directus_sessions.directus_settings.directus_users.directus_webhooks.directus_dashboards.directus_panels.directus_notifications.directus_shares.directus_flows.directus_operations.directus_translations.directus_versions.directus_extensions".split(".").includes(t))throw Error("Cannot use readItems for core collections");var t})(e),{path:`/items/${e}`,params:t??{},method:"GET"}),l={},f=(o={})=>a=>{let n={...l,...o};return{async request(l){let f=l();if(f.headers||(f.headers={}),"Content-Type"in f.headers?"multipart/form-data"===f.headers["Content-Type"]&&delete f.headers["Content-Type"]:f.headers["Content-Type"]="application/json","getToken"in this&&!("Authorization"in f.headers)){let e=await this.getToken();e&&(f.headers.Authorization=`Bearer ${e}`)}let c=((o,a,n)=>{let l="/"===o.pathname?a:(d=a,(c=o.pathname).endsWith("/")&&(c=c.slice(0,-1)),d.startsWith("/")||(d="/"+d),c+d),f=new globalThis.URL(l,o);var c,d;if(n)for(let[u,p]of Object.entries((o=>{let a={};o.fields&&(r(o.fields)&&(a.fields=(e=>{let t=(e,s=[])=>{if("object"==typeof e){let r=[];for(let i in e){let o=e[i]??[];if(Array.isArray(o))for(let e of o)r.push(t(e,[...s,i]));else if("object"==typeof o)for(let e of Object.keys(o)){let a=o[e];for(let o of a)r.push(t(o,[...s,`${i}:${e}`]))}}return r.flatMap(e=>e)}return[...s,String(e)].join(".")};return e.flatMap(e=>t(e))})(o.fields).join(",")),t(o.fields)&&(a.fields=o.fields)),i(o.filter)&&(a.filter=JSON.stringify(o.filter)),t(o.search)&&(a.search=o.search),o.sort&&(r(o.sort)&&(a.sort=o.sort.join(",")),t(o.sort)&&(a.sort=o.sort)),"limit"in o&&(s(o.limit)&&o.limit>=-1&&(a.limit=String(o.limit)),t(o.limit)&&(a.limit=o.limit)),"offset"in o&&(s(o.offset)&&o.offset>=0&&(a.offset=String(o.offset)),t(o.offset)&&(a.offset=o.offset)),"page"in o&&(s(o.page)&&o.page>=1&&(a.page=String(o.page)),t(o.page)&&(a.page=o.page)),i(o.deep)&&(a.deep=JSON.stringify(o.deep)),i(o.alias)&&(a.alias=JSON.stringify(o.alias)),i(o.aggregate)&&(a.aggregate=JSON.stringify(o.aggregate)),o.groupBy&&(r(o.groupBy)&&(a.groupBy=o.groupBy.join(",")),t(o.groupBy)&&(a.groupBy=o.groupBy)),t(o.version)&&(a.version=o.version),o.versionRaw&&("boolean"==typeof o.versionRaw&&(a.versionRaw=String(o.versionRaw)),t(o.versionRaw)&&(a.versionRaw=o.versionRaw));for(let[t,s]of Object.entries(o)){if(e.includes(t))continue;let r;r="string"==typeof s?s:JSON.stringify(s),r&&(a[t]=r)}return a})(n)))if(p&&"object"==typeof p&&!Array.isArray(p))for(let[e,t]of Object.entries(p))f.searchParams.set(`${u}[${e}]`,String(t));else f.searchParams.set(u,p);return f})(a.url,f.path,f.params),d={method:f.method??"GET",headers:f.headers??{}};"credentials"in n&&(d.credentials=n.credentials),f.body&&(d.body=f.body),f.onRequest&&(d=await f.onRequest(d)),n.onRequest&&(d=await n.onRequest(d));let u=await(async(e,t,s=globalThis.fetch)=>(t.headers="object"!=typeof t.headers||Array.isArray(t.headers)?{}:t.headers,s(e,t).then(e=>async function(e){var t,s;if("object"==typeof e&&e){if("object"==typeof(s=e)&&s&&"headers"in s&&"ok"in s&&"json"in s&&"function"==typeof s.json&&"text"in s&&"function"==typeof s.json){let s=null==(t=e.headers.get("Content-Type"))?void 0:t.toLowerCase();if((null==s?void 0:s.startsWith("application/json"))||(null==s?void 0:s.startsWith("application/health+json"))){let t=await e.json();if(!e.ok||"errors"in t)throw t;return"data"in t?t.data:t}if((null==s?void 0:s.startsWith("text/html"))||(null==s?void 0:s.startsWith("text/plain"))){let t=await e.text();if(!e.ok)throw t;return t}return 204===e.status?null:e}if("errors"in e)throw e;return"data"in e?e.data:e}}(e).catch(t=>{var s;let r={message:"",errors:t&&"object"==typeof t&&"errors"in t?t.errors:t,response:e};return t&&"object"==typeof t&&"data"in t&&(r.data=t.data),Array.isArray(r.errors)&&(null==(s=r.errors[0])?void 0:s.message)&&(r.message=r.errors[0].message),Promise.reject(r)}))))(c.toString(),d,a.globals.fetch);return"onResponse"in f&&(u=await f.onResponse(u,d)),"onResponse"in o&&(u=await o.onResponse(u,d)),u}}};export{n,f as r,a as t};
